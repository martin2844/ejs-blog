<%- include("partials/header") -%>


<section class="jumbotron text-center">
    <div class="container">
      <h2 class="jumbotron-heading">Mostrando resultados para busqueda de:</h2>
      <p class="lead text-muted"><%= keyWord %></p>
    </div>
  </section>

<% let counter = 0; %>
<div class="row">
    <% posts.forEach(function(posts) { %>
      <% const url = "/posts/" + posts._id %>
      <% const tag1Url = "/tags/" + posts.tag1 %>
      <% const tag2Url = "/tags/" + posts.tag2 %>
      <% const postContent = posts.content.toLowerCase(); %>
      <% const postTitle = posts.title.toLowerCase(); %>
      <% let month = posts.mm %>
      <% switch(month){case 1:month="Enero";break;case 2:month="Febrero";break;case 3:month="Marzo";break;case 4:month="Abril";break;case 5:month="Mayo";break;case 6:month="Junio";break;case 7:month="Julio";break;case 8:month="Agosto";break;case 9:month="Septiembre";break;case 10:month="Octubre";break;case 11:month="Noviembre";break;case 12:month="Diciembre"} %>

      <% if (postContent.includes(keyWord) || postTitle.includes(keyWord)) { %>
      <div class="col-md-4">
          <div class="card mb-4 shadow-sm">
              <div class="date"><span class="day"><%= posts.dd %></span><span class="month"><%= month %></span></div>
            <a href="<%= url %>"><img class="card-img-top" src="<%=posts.imageURL%>" alt="Card image cap"></a>
              <div class="card-body">
                <h1><%=  posts.title %></h1>
                <% var noTags = posts.noTags.replace(/&nbsp;|&#39;/g, ' '); %>
                <p style="text-align: justify;"><%=  noTags.substring(0,300) %> ...</p>

                        



                          <a href="<%= url %>" class="btn btn-outline-secondary btn-sm" role="button" aria-pressed="true">Leer MÃ¡s</a>
                          <a href="<%= tag1Url %>" class="btn btn-outline-primary btn-sm" role="button" aria-pressed="true">#<%= posts.tag1 %></a>
                          <a href="<%= tag2Url %>" class="btn btn-outline-primary btn-sm" role="button" aria-pressed="true">#<%= posts.tag2 %></a>

             </div>
         </div>
       </div>

       <% counter++ } else {   %>


    <% } %>

              <%});%>
              </div>
<!-- End of card loops -->


<% if (counter >= 1) { %>
<div class="row yt">
      <div class="col-lg">
  <p> Found <%= counter %> results.    </p>

  </div>
    </div>
  <% } else { %>
    <div class="row yt">
          <div class="col-lg">
    <h3> No content found</h3>
  </div>
    </div>
    <% } %>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>



<%- include("partials/footer") -%>
